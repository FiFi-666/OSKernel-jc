# 本部分为内核的信号

信号（signal）是内核进程间通信的手段之一。具体表现为，当进程（线程）收到某个信号时，需要向调用对应的信号处理函数。在信号处理函数执行结束后，再次返回到进程（线程）上一次执行的位置。

所以，信号的难点在于，信号处理函数执行结束后，需要再次跳回到内核态，然后恢复用户程序寄存器，再返回到用户态。

而这个难点，现在的posix标准已经帮我们提供了一部分的解决方案：sigreturn系统调用。

## 具体实现

首先，我们在内核中加入信号蹦床（trampoline）段，这个段做的事情只有一个，就是调用sigreturn系统调用。

```
	.section .signalTrampoline
    .globl signalTrampoline
    .align 12
signalTrampoline:
    li a7, 139
    ecall

```

其次，我们在执行信号处理函数时，将用户态ra寄存器设置为signalTrampoline。

这样，程序将在执行完signal处理函数后，跳到这段代码，并将调用139号系统调用，进入到sigreturn函数。在这个函数，我们会恢复用户态寄存器，使程序恢复运行。


## 信号todo
不同信号的嵌套处理

同种信号的不可重入
